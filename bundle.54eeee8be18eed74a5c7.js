(()=>{"use strict";var t=function(){function t(t){this.$nativeElement="string"==typeof t?document.querySelector(t):t}return t.prototype.html=function(t){return"string"==typeof t?(this.$nativeElement.innerHTML=t,this):(this.$nativeElement.outerHTML.trim(),this)},t.prototype.clear=function(){return this.html(""),this},t.prototype.on=function(t,e){this.$nativeElement.addEventListener(t,e)},t.prototype.off=function(t,e){this.$nativeElement.removeEventListener(t,e)},t.prototype.append=function(t){return this.$nativeElement.append(t.$nativeElement),this},Object.defineProperty(t.prototype,"data",{get:function(){return this.$nativeElement.dataset},enumerable:!1,configurable:!0}),t.prototype.closest=function(t){return e(this.$nativeElement.closest(t))},t.prototype.find=function(t){return this.$nativeElement.querySelector(t)},t.prototype.findAll=function(t){return this.$nativeElement.querySelectorAll(t)},t.prototype.focus=function(){return this.$nativeElement.focus(),this},Object.defineProperty(t.prototype,"textContent",{get:function(){return this.$nativeElement.textContent},set:function(t){this.$nativeElement.textContent=t},enumerable:!1,configurable:!0}),t.prototype.getCoords=function(){return this.$nativeElement.getBoundingClientRect()},t.prototype.css=function(t){var e=this;Object.keys(t).forEach((function(o){""===t[o]?e.$nativeElement.style.removeProperty(o):e.$nativeElement.style[o]=t[o]}))},t.prototype.addClass=function(t){this.$nativeElement.classList.add(t)},t.prototype.removeClass=function(t){this.$nativeElement.classList.remove(t)},t}();function e(e){return e?new t(e):null}e.create=function(t,o){void 0===o&&(o="");var n=document.createElement(t);return o&&n.classList.add(o),e(n)};var o,n,r=function(){function t(){this.handlers={}}return t.prototype.subscribe=function(t,e){this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e)},t.prototype.dispose=function(t){delete this.handlers[t]},t.prototype.notify=function(t,e){void 0===e&&(e=null);var o=this.handlers[t];if(o)for(var n=0,r=o;n<r.length;n++)r[n].call({},e)},t}(),l=function(){function t(t,o){this.$el=e(t),this.options=o,this.componentsRaw=o.components||[],this.components=[],o.observable=new r}return t.prototype.getRoot=function(){var t=this,o=e.create("div","spreadsheet");return this.componentsRaw.forEach((function(n){var r=e.create("div",n.className),l=new n(r,t.options);r.html(l.toHtml()),o.append(r),t.components.push(l)})),o},t.prototype.render=function(){this.$el.append(this.getRoot()),this.components.forEach((function(t){return t.init()}))},t.prototype.dispose=function(){this.components.forEach((function(t){return t.dispose()}))},t}(),i=function(){function t(t,e){if(void 0===e&&(e=[]),!t)throw new Error("No $root provided for DomListener");this.$root=t,this.listeners=e}return t.prototype.initDomListeners=function(){var t=this;this.listeners.forEach((function(e){var o=a(e);if(!t[o])throw new Error("Method "+o+" is not implemented in "+(t.name||"")+" component.");t[o]=t[o].bind(t),t.$root.on(e,t[o])}))},t.prototype.removeDomListeners=function(){var t=this;this.listeners.forEach((function(e){var o=a(e);if(!t[o])throw new Error("Method "+o+" is not implemented in "+(t.name||"")+" component.");t.$root.off(e,t[o])}))},t}(),a=function(t){return"on"+t.charAt(0).toUpperCase()+t.slice(1,t.length)},s=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e,o){void 0===o&&(o={});var n=t.call(this,e,o.listeners)||this;return n.name=o.name||"",n.observable=o.observable,n.store=o.store,n.options=o,n}return s(e,t),e.prototype.init=function(){this.initDomListeners(),this.loadState()},e.prototype.dispose=function(){this.removeDomListeners()},e}(i),u=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),d=function(t){function e(e,o){return t.call(this,e,o)||this}return u(e,t),e.prototype.loadState=function(){},e.prototype.toHtml=function(){return'<input type="text" class="input" value="New spreadsheet" />\n                <div>\n                    <div class="button">\n                        <i class="material-icons">delete</i>\n                    </div>\n                    <div class="button">\n                        <i class="material-icons">exit_to_app</i>\n                    </div>\n                </div>'},e.prototype.onClick=function(t){console.log("Header: onInput",t)},e.componentName="header",e.className="spreadsheet__"+e.componentName,e}(c),p=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),m=function(t){function e(e,o){return o.listeners=["click"],t.call(this,e,o)||this}return p(e,t),e.prototype.loadState=function(){},e.prototype.toHtml=function(){return'<div class="button undo">\n                    <i class="material-icons">undo</i>\n                </div>\n                <div class="button redo">\n                    <i class="material-icons">redo</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button content_cut">\n                    <i class="material-icons">content_cut</i>\n                </div>\n                <div class="button content_copy">\n                    <i class="material-icons">content_copy</i>\n                </div>\n                <div class="button content_paste">\n                    <i class="material-icons">content_paste</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button format_bold">\n                    <i class="material-icons">format_bold</i>\n                </div>\n                <div class="button format_italic">\n                    <i class="material-icons">format_italic</i>\n                </div>\n                <div class="button format_underlined">\n                    <i class="material-icons">format_underlined</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button align_vertical_top">\n                    <i class="material-icons">align_vertical_top</i>\n                </div>\n                <div class="button align_vertical_center">\n                    <i class="material-icons">align_vertical_center</i>\n                </div>\n                <div class="button align_vertical_bottom">\n                    <i class="material-icons">align_vertical_bottom</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button format_align_left">\n                    <i class="material-icons">format_align_left</i>\n                </div>\n                <div class="button format_align_center">\n                    <i class="material-icons">format_align_center</i>\n                </div>\n                <div class="button format_align_right">\n                    <i class="material-icons">format_align_right</i>\n                </div>'},e.prototype.onClick=function(t){var e=t.target.closest(".button");e&&(e.classList.contains("undo")?this.undoButtonClick():e.classList.contains("redo")?this.redoButtonClick():e.classList.contains("content_cut")?this.cutButtonClick():e.classList.contains("content_copy")?this.copyButtonClick():e.classList.contains("content_paste")?this.pasteButtonClick():e.classList.contains("format_bold")?this.formatBoldButtonClick():e.classList.contains("format_italic")?this.formatItalicButtonClick():e.classList.contains("format_underlined")?this.formatUnderlinedButtonClick():e.classList.contains("align_vertical_top")?this.alignVerticalTopButtonClick(null):e.classList.contains("align_vertical_center")?this.alignVerticalCenterButtonClick(null):e.classList.contains("align_vertical_bottom")?this.alignVerticalBottomButtonClick(null):e.classList.contains("format_align_left")?this.formatAlignLeftButtonClick():e.classList.contains("format_align_center")?this.formatAlignCenterButtonClick():e.classList.contains("format_align_right")&&this.formatAlignRightButtonClick())},e.prototype.undoButtonClick=function(){console.log("undoButtonClick")},e.prototype.redoButtonClick=function(){console.log("redoButtonClick")},e.prototype.cutButtonClick=function(){console.log("cutButtonClick")},e.prototype.copyButtonClick=function(){console.log("copyButtonClick")},e.prototype.pasteButtonClick=function(){console.log("pasteButtonClick")},e.prototype.formatBoldButtonClick=function(){console.log("formatBoldButtonClick")},e.prototype.formatItalicButtonClick=function(){console.log("formatItalicButtonClick")},e.prototype.formatUnderlinedButtonClick=function(){console.log("formatUnderlinedButtonClick")},e.prototype.alignVerticalTopButtonClick=function(t){t.classList.remove("align-vertical-center align-vertical-bottom"),t.classList.add("align-vertical-top")},e.prototype.alignVerticalCenterButtonClick=function(t){t.classList.remove("align-vertical-top align-vertical-bottom"),t.classList.add("align-vertical-center")},e.prototype.alignVerticalBottomButtonClick=function(t){t.classList.remove("align-vertical-top align-vertical-center"),t.classList.add("align-vertical-bottom")},e.prototype.formatAlignLeftButtonClick=function(){console.log("formatAlignLeftButtonClick")},e.prototype.formatAlignCenterButtonClick=function(){console.log("formatAlignCenterButtonClick")},e.prototype.formatAlignRightButtonClick=function(){console.log("formatAlignRightButtonClick")},e.componentName="toolbar",e.className="spreadsheet__"+e.componentName,e}(c);!function(t){t[t.formulaInput=0]="formulaInput",t[t.cellInput=1]="cellInput",t[t.singleCellSelect=2]="singleCellSelect",t[t.selectNextCellAfterFormulaInput=3]="selectNextCellAfterFormulaInput",t[t.clearSelectedCells=4]="clearSelectedCells"}(n||(n={}));var f,h=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),v=function(t){function e(e,o){return o.listeners=["keydown","input"],t.call(this,e,o)||this}return h(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.$root.find(".input");this.observable.subscribe(n.singleCellSelect,(function(t){t.columnNumber,t.rowNumber;var o=t.content;null===o&&(o=""),e.textContent=o})),this.observable.subscribe(n.cellInput,(function(t){null===t&&(t=""),e.textContent=t}))},e.prototype.loadState=function(){},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.observable.dispose(n.singleCellSelect),this.observable.dispose(n.cellInput)},e.prototype.toHtml=function(){return'<div class="info">f</div>\n                <div class="input" contenteditable="true" spellcheck="false"></div>'},e.prototype.onInput=function(t){if(null!==t.data){var e=t.target.textContent.trim();this.observable.notify(n.formulaInput,e)}else t.preventDefault()},e.prototype.onKeydown=function(t){"Enter"===t.key&&this.observable.notify(n.selectNextCellAfterFormulaInput)},e.componentName="formula",e.className="spreadsheet__"+e.componentName,e.stateProperties={formulaBarText:"formulaBarText"},e}(c);function b(t){for(var e=[];t>0;){var o=String.fromCharCode((t-1)%26+"A".charCodeAt(0));e.push(o),t=Math.floor((t-1)/26)}return e.reverse().join("")}function y(t,e){for(var o='<div class="row" data-row-number="'+t+'" data-resizable="true">\n                    <div class="row-data">\n                        ',n=1;n<=e;n++)o+='<div class="cell align-vertical-bottom" data-cell-row-number="'+t+'" data-cell-column-number="'+n+'" contenteditable="true"></div>';return o+"</div></div>"}function C(t,e,o){return{type:f.changeCellContent,data:{columnNumber:t,rowNumber:e,value:o}}}!function(t){t.columnResize="columnResize",t.rowResize="rowResize",t.changeCellContent="changeCellContent"}(f||(f={}));var w=function(){function t(t,o){var r=this;this.spreadsheetEl=document.querySelector(".spreadsheet__"+N.componentName),this.observable=o,this.store=t,this.observable.subscribe(n.clearSelectedCells,(function(){r.iterateOverSelectedCells((function(t){var o=e(t);o.textContent="",r.store.dispatch(C(+o.data.cellColumnNumber,+o.data.cellRowNumber,""))})),r.currentSelectedCell.textContent="",r.store.dispatch(C(+r.currentSelectedCell.data.cellColumnNumber,+r.currentSelectedCell.data.cellRowNumber,"")),r.observable.notify(n.cellInput,"")}))}return t.prototype.selectCells=function(o,r,l,i){if(o===l&&r===i){this.clearSelection(),this.selectedPivot=null;var a=e(document.querySelector(".spreadsheet__table").querySelector('[data-cell-column-number="'+o+'"][data-cell-row-number="'+r+'"]'));this.currentSelectedCell=a,a.focus().addClass(t.selectedCellClassName),this.observable.notify(n.singleCellSelect,{columnNumber:+a.data.cellColumnNumber,rowNumber:+a.data.cellRowNumber,content:a.textContent}),this.initialMouseSelectedCell=a}this.iterateOverSelectedCells((function(e){e.classList.remove(t.selectedCellClassName)}),(function(t){t.classList.remove("selected")}),(function(t){t.classList.remove("selected")})),this.selectedRange={col1:Math.min(o,l),row1:Math.min(r,i),col2:Math.max(o,l),row2:Math.max(r,i)},this.iterateOverSelectedCells((function(e){e.classList.add(t.selectedCellClassName)}),(function(t){t.classList.add("selected")}),(function(t){t.classList.add("selected")}))},t.prototype.iterateOverSelectedCells=function(t,e,o){if(void 0===e&&(e=null),void 0===o&&(o=null),this.selectedRange)for(var n=document.querySelector(".spreadsheet__table"),r=n.querySelector('[data-column-number="'+this.selectedRange.col1+'"]'),l=n.querySelector('[data-row-number="'+this.selectedRange.row1+'"]'),i=n.querySelector('[data-column-number="'+this.selectedRange.col2+'"]'),a=n.querySelector('[data-row-number="'+this.selectedRange.row2+'"]'),s=l;s&&+s.dataset.rowNumber<=+a.dataset.rowNumber;){e&&e(s);for(var c=r,u=s.dataset.rowNumber;c&&+c.dataset.columnNumber<=+i.dataset.columnNumber;){o&&o(c);var d=c.dataset.columnNumber;t(n.querySelector('[data-cell-column-number="'+d+'"][data-cell-row-number="'+u+'"]')),c=c.nextElementSibling}s=s.nextElementSibling}},t.prototype.clearSelection=function(){if(this.currentSelectedCell){var e=this.spreadsheetEl.querySelector('.table-header .column[data-column-number="'+this.currentSelectedCell.data.cellColumnNumber+'"]'),o=this.spreadsheetEl.querySelector('.column-row-info .row-info[data-row-number="'+this.currentSelectedCell.data.cellRowNumber+'"]');e.classList.remove("selected"),o.classList.remove("selected"),this.currentSelectedCell.removeClass(t.selectedCellClassName),this.currentSelectedCell=null}this.selectedRange&&(this.iterateOverSelectedCells((function(e){e.classList.remove(t.selectedCellClassName)}),(function(t){t.classList.remove("selected")}),(function(t){t.classList.remove("selected")})),this.selectedRange=null)},t.selectedCellClassName="selected",t}(),g=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),N=function(t){function o(e,o){var n=this;return o.listeners=["mousedown","mousemove","mouseup","keydown","input"],(n=t.call(this,e,o)||this).store=o.store,n}return g(o,t),o.prototype.init=function(){var e=this;t.prototype.init.call(this),this.tableSelection=new w(this.store,this.observable),this.tableSelection.selectCells(1,1,1,1),this.tableSelection.initialMouseSelectedCell=null,this.observable.subscribe(n.formulaInput,(function(t){e.tableSelection.currentSelectedCell.textContent=t;var o=+e.tableSelection.currentSelectedCell.data.cellColumnNumber,n=+e.tableSelection.currentSelectedCell.data.cellRowNumber;e.options.store.dispatch(C(o,n,t))})),this.observable.subscribe(n.selectNextCellAfterFormulaInput,(function(){var t=e.getNextCell("Enter");e.tableSelection.selectCells(+t.data.cellColumnNumber,+t.data.cellRowNumber,+t.data.cellColumnNumber,+t.data.cellRowNumber)}));var o=0,r=0;this.$root.find(".table-wrapper").addEventListener("scroll",(function(t){var n=t.target.closest(".table-body").querySelector(".column-row-info"),l=e.$root.find(".table-header .row-data"),i=t.target.scrollLeft,a=t.target.scrollTop;o!==i&&(l.style.marginLeft=40-i+"px",o=i),r!==a&&(n.style.marginTop=-a+"px",r=a)}))},o.prototype.loadState=function(){var t=this.store.getState()[o.componentName];this.restoreColumnWidths(t),this.restoreRowHeights(t),this.restoreTableContent(t)},o.prototype.dispose=function(){t.prototype.dispose.call(this),this.observable.dispose(n.formulaInput),this.observable.dispose(n.selectNextCellAfterFormulaInput)},o.prototype.toHtml=function(){return this.rowCount=100,this.columnCount=30,function(t,e){for(var o='<div class="table-header">'+function(t){for(var e='<div class="row">                    \n                    <div class="row-info"></div>\n                        <div class="row-data">',o=1;o<=t;o++)e+='<div class="column" data-column-number="'+o+'" data-resizable="true"><div class="column-title">'+b(o)+'</div><div data-resize="col" class="col-resize"></div></div>';return e+'</div><div class="row-column-info-patch"></div></div>'}(e)+'</div>\n                <div class="table-body"><div class="column-row-info-container"><div class="column-row-info">',n=1;n<=t;n++)o+='<div class="row-info" data-row-number="'+n+'"><div class="row-number">'+n+'</div><div class="row-resize"><div data-resize="row" class="handler"></div></div></div>';for(o+='</div></div><div class="table-wrapper">',n=1;n<=t;n++)o+=y(n,e);return o+'</div><div class="column-row-info-patch"></div></div>'}(this.rowCount,this.columnCount)},o.prototype.onMousedown=function(t){var o=this,n=t.target;if(n.dataset.resize){var r=e(n);if("col"===r.data.resize){var l=r.closest('[data-resizable="true"]');this.resizeColumn(l,r)}else{var i=r.closest(".row-info").data.rowNumber,a=e(r.closest(".table-body").find('.table-wrapper .row[data-row-number="'+i+'"]'));this.resizeRow(a,r)}}else{if(n.classList.contains("cell")){var s=this.tableSelection.currentSelectedCell;if(t.shiftKey&&s){var c=e(n);this.tableSelection.selectCells(+s.data.cellColumnNumber,+s.data.cellRowNumber,+c.data.cellColumnNumber,+c.data.cellRowNumber)}else{var u=e(n);this.tableSelection.selectCells(+u.data.cellColumnNumber,+u.data.cellRowNumber,+u.data.cellColumnNumber,+u.data.cellRowNumber)}}var d=function(e,n,r,l){var i,a,s;e===r?(i="column",a=e):(i="row",s=n),o.tableSelection.selectedPivot&&o.tableSelection.selectedPivot.type!==i&&(o.tableSelection.selectedPivot=null),t.shiftKey&&o.tableSelection.selectedPivot?"column"===i?e=o.tableSelection.selectedPivot.number:n=o.tableSelection.selectedPivot.number:o.tableSelection.selectedPivot={type:i,number:"column"===i?a:s},o.tableSelection.clearSelection(),o.tableSelection.selectCells(e,n,r,l)},p=n.closest(".row-info");if(p&&p.childElementCount>0){var m=(a=e(p.closest(".table-body")).find('.table-wrapper .row[data-row-number="'+p.dataset.rowNumber+'"]')).querySelector(".row-data"),f=(s=e(m.firstElementChild),e(m.lastElementChild));d(+s.data.cellColumnNumber,+s.data.cellRowNumber,+f.data.cellColumnNumber,+f.data.cellRowNumber)}else p&&0===p.childElementCount&&d(1,1,this.columnCount,this.rowCount);var h=n.closest(".column");if(h){var v=e(h).data.columnNumber,b=this.$root.findAll('.cell[data-cell-column-number="'+v+'"]');s=e(b[0]),f=e(b[b.length-1]),d(+s.data.cellColumnNumber,+s.data.cellRowNumber,+f.data.cellColumnNumber,+f.data.cellRowNumber)}}},o.prototype.resizeColumn=function(t,o){var n=this,r=t.getCoords(),l=this.$root.findAll('[data-cell-column-number="'+t.data.columnNumber+'"]');o.css({height:"100vh"});var i={},a=function(t){t.target.classList.contains("column")&&(i[e(t.target).data.columnNumber]=t.target,t.target.style.pointerEvents="none");var n=t.pageX-o.getCoords().right;o.css({left:parseInt(window.getComputedStyle(o.$nativeElement).left)+n+"px",opacity:1})};document.addEventListener("mousemove",a),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",a),o.css({height:"",opacity:""});var e=o.getCoords().right-r.right,s=r.width+e;n.setColumnWidth(t,l,s),Object.keys(i).forEach((function(t){return i[t].style.removeProperty("pointer-events")}))}),{once:!0})},o.prototype.setColumnWidth=function(t,e,o){var n,r;t.css({width:o+"px"}),e.forEach((function(t){t.style.width=o+"px"})),this.store.dispatch((n=+t.data.columnNumber,r=o,{type:f.columnResize,data:{columnNumber:n,newColumnWidth:r}}))},o.prototype.resizeRow=function(t,o){var n=this,r=t.getCoords();o.css({width:"100%"});var l={},i=function(t){var n=t.target.closest(".row-info");if(n){var r=e(n).data.rowNumber;l[r]=n,n.style.pointerEvents="none"}var i=t.pageY-o.getCoords().bottom;o.css({top:parseInt(window.getComputedStyle(o.$nativeElement).top)+i+"px",opacity:1})};document.addEventListener("mousemove",i),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",i),o.css({width:"",opacity:""});var e=o.getCoords().bottom-r.bottom,a=r.height+e;n.setRowHeight(t,a),Object.keys(l).forEach((function(t){return l[t].style.removeProperty("pointer-events")}))}),{once:!0})},o.prototype.setRowHeight=function(t,o){var n=t.data.rowNumber;t.css({height:o+"px"}),e(t.closest(".table-body").find('.column-row-info .row-info[data-row-number="'+n+'"]')).css({height:o+"px"}),this.store.dispatch(function(t,e){return{type:f.rowResize,data:{rowNumber:t,newRowHeight:e}}}(+t.data.rowNumber,o))},o.prototype.onMouseup=function(t){this.tableSelection.initialMouseSelectedCell&&(this.tableSelection.initialMouseSelectedCell=null)},o.prototype.onMousemove=function(t){var o=t.target;if(this.tableSelection.initialMouseSelectedCell&&o.classList.contains("cell")){var n=e(o),r=this.tableSelection.initialMouseSelectedCell;this.tableSelection.selectCells(+r.data.cellColumnNumber,+r.data.cellRowNumber,+n.data.cellColumnNumber,+n.data.cellRowNumber)}},o.prototype.onKeydown=function(t){if(["Enter","Tab","ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Home"].includes(t.key)){t.preventDefault();var e=this.getNextCell(t.key,t.shiftKey,t.ctrlKey);this.tableSelection.selectCells(+e.data.cellColumnNumber,+e.data.cellRowNumber,+e.data.cellColumnNumber,+e.data.cellRowNumber)}else"Delete"===t.key&&this.observable.notify(n.clearSelectedCells)},o.prototype.onInput=function(t){var e=t.target.textContent.trim(),o=this.tableSelection.currentSelectedCell,r=+o.data.cellColumnNumber,l=+o.data.cellRowNumber;this.store.dispatch(C(r,l,e)),this.observable.notify(n.cellInput,e)},o.prototype.setCellValue=function(t,o,n){var r=e(this.$root.find('[data-cell-column-number="'+t+'"][data-cell-row-number="'+o+'"]'));r&&(r.textContent=n)},o.prototype.restoreColumnWidths=function(t){var o=this;Object.keys(t.columnWidths).forEach((function(n){var r=e(o.$root.find('.table-header [data-column-number="'+n+'"]')),l=o.$root.findAll('[data-cell-column-number="'+r.data.columnNumber+'"]'),i=t.columnWidths[n];o.setColumnWidth(r,l,i)}))},o.prototype.restoreRowHeights=function(t){var o=this;Object.keys(t.rowHeights).forEach((function(n){var r=e(o.$root.find('.table-wrapper .row[data-row-number="'+n+'"]')),l=t.rowHeights[n];o.setRowHeight(r,l)}))},o.prototype.restoreTableContent=function(t){var e=this;Object.keys(t.cellContents).forEach((function(o){Object.keys(t.cellContents[o]).forEach((function(n){var r=t.cellContents[o][n];r&&e.setCellValue(+o,+n,r)}))}))},o.prototype.getNextCell=function(t,o,n){void 0===o&&(o=!1),void 0===n&&(n=!1);var r=this.tableSelection.currentSelectedCell,l=+r.data.cellColumnNumber,i=+r.data.cellRowNumber,a=[l,i];return"Enter"===t?a=o?[l,i-1]:[l,i+1]:"Tab"===t?a=o?[l-1,i]:[l+1,i]:"ArrowUp"===t?a=[l,i-1]:"ArrowRight"===t?a=[l+1,i]:"ArrowDown"===t?a=[l,i+1]:"ArrowLeft"===t?a=[l-1,i]:"Home"===t&&(a=n?[1,1]:[1,i]),e(this.$root.find('[data-cell-column-number="'+a[0]+'"][data-cell-row-number="'+a[1]+'"]'))},o.componentName="table",o.className="spreadsheet__"+o.componentName,o.stateProperties={columnWidths:"columnWidths",rowHeights:"rowHeights",cellContents:"cellContents"},o}(c);function _(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var S="function"==typeof Symbol&&Symbol.observable||"@@observable",E=function(){return Math.random().toString(36).substring(7).split("").join(".")},L={INIT:"@@redux/INIT"+E(),REPLACE:"@@redux/REPLACE"+E(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+E()}};function R(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}var O,k,x,B=function(){return(B=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},A=function t(e,o,n){var r;if("function"==typeof o&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(_(0));if("function"==typeof o&&void 0===n&&(n=o,o=void 0),void 0!==n){if("function"!=typeof n)throw new Error(_(1));return n(t)(e,o)}if("function"!=typeof e)throw new Error(_(2));var l=e,i=o,a=[],s=a,c=!1;function u(){s===a&&(s=a.slice())}function d(){if(c)throw new Error(_(3));return i}function p(t){if("function"!=typeof t)throw new Error(_(4));if(c)throw new Error(_(5));var e=!0;return u(),s.push(t),function(){if(e){if(c)throw new Error(_(6));e=!1,u();var o=s.indexOf(t);s.splice(o,1),a=null}}}function m(t){if(!R(t))throw new Error(_(7));if(void 0===t.type)throw new Error(_(8));if(c)throw new Error(_(9));try{c=!0,i=l(i,t)}finally{c=!1}for(var e=a=s,o=0;o<e.length;o++)(0,e[o])();return t}function f(t){if("function"!=typeof t)throw new Error(_(10));l=t,m({type:L.REPLACE})}function h(){var t,e=p;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(_(11));function o(){t.next&&t.next(d())}return o(),{unsubscribe:e(o)}}})[S]=function(){return this},t}return m({type:L.INIT}),(r={dispatch:m,subscribe:p,getState:d,replaceReducer:f})[S]=h,r}((function(t,e){switch(e.type){case f.columnResize:return(o=B({},t)).table.columnWidths[e.data.columnNumber]=e.data.newColumnWidth,o;case f.rowResize:return(o=B({},t)).table.rowHeights[e.data.rowNumber]=e.data.newRowHeight,o;case f.changeCellContent:var o;return(o=B({},t)).table.cellContents[e.data.columnNumber]||(o.table.cellContents[e.data.columnNumber]={}),o.table.cellContents[e.data.columnNumber][e.data.rowNumber]=e.data.value,o;default:return t}}),(x=localStorage.getItem("appState"))?JSON.parse(x):((O={})[""+d.componentName]={},O[""+m.componentName]={},O[""+N.componentName]=((k={})[""+N.stateProperties.columnWidths]={},k[""+N.stateProperties.rowHeights]={},k[""+N.stateProperties.cellContents]={},k),O));A.subscribe((function(){var t=A.getState();localStorage.setItem("appState",JSON.stringify(t))})),new l("#app",{components:[d,m,v,N],store:A}).render()})();