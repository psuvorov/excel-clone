(()=>{"use strict";var t=function(){function t(t){this.$nativeElement="string"==typeof t?document.querySelector(t):t}return t.prototype.html=function(t){return"string"==typeof t?(this.$nativeElement.innerHTML=t,this):(this.$nativeElement.outerHTML.trim(),this)},t.prototype.clear=function(){return this.html(""),this},t.prototype.on=function(t,e){this.$nativeElement.addEventListener(t,e)},t.prototype.off=function(t,e){this.$nativeElement.removeEventListener(t,e)},t.prototype.append=function(t){return this.$nativeElement.append(t.$nativeElement),this},Object.defineProperty(t.prototype,"data",{get:function(){return this.$nativeElement.dataset},enumerable:!1,configurable:!0}),t.prototype.closest=function(t){return e(this.$nativeElement.closest(t))},t.prototype.find=function(t){return this.$nativeElement.querySelector(t)},t.prototype.findAll=function(t){return this.$nativeElement.querySelectorAll(t)},t.prototype.focus=function(){return this.$nativeElement.focus(),this},Object.defineProperty(t.prototype,"textContent",{get:function(){return this.$nativeElement.textContent},set:function(t){this.$nativeElement.textContent=t},enumerable:!1,configurable:!0}),t.prototype.getCoords=function(){return this.$nativeElement.getBoundingClientRect()},t.prototype.css=function(t){var e=this;Object.keys(t).forEach((function(o){""===t[o]?e.$nativeElement.style.removeProperty(o):e.$nativeElement.style[o]=t[o]}))},t.prototype.addClass=function(){for(var t,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];(t=this.$nativeElement.classList).add.apply(t,e)},t.prototype.removeClass=function(){for(var t,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];(t=this.$nativeElement.classList).remove.apply(t,e)},t.prototype.toggleClass=function(t){this.$nativeElement.classList.toggle(t)},t}();function e(e){return e?new t(e):null}e.create=function(t,o){void 0===o&&(o="");var n=document.createElement(t);return o&&n.classList.add(o),e(n)};var o,n,l,r,i=function(){function t(){this.handlers={}}return t.prototype.subscribe=function(t,e){this.handlers[t]=this.handlers[t]||[],this.handlers[t].push(e)},t.prototype.dispose=function(t){delete this.handlers[t]},t.prototype.notify=function(t,e){void 0===e&&(e=null);var o=this.handlers[t];if(o)for(var n=0,l=o;n<l.length;n++)l[n].call({},e)},t}(),a=function(){function t(t,o){this.$el=e(t),this.options=o,this.componentsRaw=o.components||[],this.components=[],o.observable=new i}return t.prototype.getRoot=function(){var t=this,o=e.create("div","spreadsheet");return this.componentsRaw.forEach((function(n){var l=e.create("div",n.className),r=new n(l,t.options);l.html(r.toHtml()),o.append(l),t.components.push(r)})),o},t.prototype.render=function(){this.$el.append(this.getRoot()),this.components.forEach((function(t){return t.init()}))},t.prototype.dispose=function(){this.components.forEach((function(t){return t.dispose()}))},t}(),s=function(){function t(t,e){if(void 0===e&&(e=[]),!t)throw new Error("No $root provided for DomListener");this.$root=t,this.listeners=e}return t.prototype.initDomListeners=function(){var t=this;this.listeners.forEach((function(e){var o=c(e);if(!t[o])throw new Error("Method "+o+" is not implemented in "+(t.name||"")+" component.");t[o]=t[o].bind(t),t.$root.on(e,t[o])}))},t.prototype.removeDomListeners=function(){var t=this;this.listeners.forEach((function(e){var o=c(e);if(!t[o])throw new Error("Method "+o+" is not implemented in "+(t.name||"")+" component.");t.$root.off(e,t[o])}))},t}(),c=function(t){return"on"+t.charAt(0).toUpperCase()+t.slice(1,t.length)},u=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(e,o){void 0===o&&(o={});var n=t.call(this,e,o.listeners)||this;return n.name=o.name||"",n.observable=o.observable,n.store=o.store,n.options=o,n}return u(e,t),e.prototype.init=function(){this.initDomListeners(),this.loadState()},e.prototype.dispose=function(){this.removeDomListeners()},e}(s),m=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),f=function(t){function e(e,o){return t.call(this,e,o)||this}return m(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.loadState=function(){},e.prototype.toHtml=function(){return'<input type="text" class="input" value="New spreadsheet" />\n                <div>\n                    <div class="button">\n                        <i class="material-icons">delete</i>\n                    </div>\n                    <div class="button">\n                        <i class="material-icons">exit_to_app</i>\n                    </div>\n                </div>'},e.prototype.onClick=function(t){console.log("Header: onInput",t)},e.componentName="header",e.className="spreadsheet__"+e.componentName,e}(d);function b(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var o=0;o<t.length;o++)if(void 0===t[o]||null===t[o])return!1;return!0}!function(t){t[t.FormulaInput=0]="FormulaInput",t[t.CellInput=1]="CellInput",t[t.SingleCellSelected=2]="SingleCellSelected",t[t.NextCellSelectionRequested=3]="NextCellSelectionRequested",t[t.CellsDeselectionRequested=4]="CellsDeselectionRequested",t[t.CutCellsRequested=5]="CutCellsRequested",t[t.CopyCellsRequested=6]="CopyCellsRequested",t[t.PasteCellsRequested=7]="PasteCellsRequested",t[t.FormatBoldButtonClicked=8]="FormatBoldButtonClicked",t[t.FormatItalicButtonClicked=9]="FormatItalicButtonClicked",t[t.FormatUnderlinedButtonClicked=10]="FormatUnderlinedButtonClicked",t[t.AlignVerticalTopButtonClicked=11]="AlignVerticalTopButtonClicked",t[t.AlignVerticalCenterButtonClicked=12]="AlignVerticalCenterButtonClicked",t[t.AlignVerticalBottomButtonClicked=13]="AlignVerticalBottomButtonClicked",t[t.FormatAlignLeftButtonClicked=14]="FormatAlignLeftButtonClicked",t[t.FormatAlignCenterButtonClicked=15]="FormatAlignCenterButtonClicked",t[t.FormatAlignRightButtonClicked=16]="FormatAlignRightButtonClicked"}(n||(n={})),function(t){t.Top="Top",t.Center="Center",t.Bottom="Bottom"}(l||(l={})),function(t){t.Left="Left",t.Center="Center",t.Right="Right"}(r||(r={}));var p,C=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),h=function(t){function o(e,o){return o.listeners=["click"],t.call(this,e,o)||this}return C(o,t),o.prototype.init=function(){var o=this;t.prototype.init.call(this);var l=this.$root;this.buttons={boldButton:e(l.find(".format_bold")),italicButton:e(l.find(".format_italic")),underlinedButton:e(l.find(".format_underlined")),alignVerticalTopButton:e(l.find(".align_vertical_top")),alignVerticalCenterButton:e(l.find(".align_vertical_center")),alignVerticalBottomButton:e(l.find(".align_vertical_bottom")),formatAlignLeftButton:e(l.find(".format_align_left")),formatAlignCenterButton:e(l.find(".format_align_center")),formatAlignRightButton:e(l.find(".format_align_right"))},this.observable.subscribe(n.SingleCellSelected,(function(t){var e=t.columnNumber,n=t.rowNumber,l=o.store.getState(),r=function(){o.buttons.boldButton.removeClass("active"),o.buttons.italicButton.removeClass("active"),o.buttons.underlinedButton.removeClass("active"),o.buttons.alignVerticalTopButton.removeClass("active"),o.buttons.alignVerticalCenterButton.removeClass("active"),o.buttons.alignVerticalBottomButton.addClass("active"),o.buttons.formatAlignLeftButton.addClass("active"),o.buttons.formatAlignCenterButton.removeClass("active"),o.buttons.formatAlignRightButton.removeClass("active")};if(b(l.table.cellContents[e])&&b(l.table.cellContents[e][n])){var i=l.table.cellContents[e][n];b(i.tableCellStyle)?(!0===i.tableCellStyle.bold?o.buttons.boldButton.addClass("active"):o.buttons.boldButton.removeClass("active"),!0===i.tableCellStyle.italic?o.buttons.italicButton.addClass("active"):o.buttons.italicButton.removeClass("active"),!0===i.tableCellStyle.underlined?o.buttons.underlinedButton.addClass("active"):o.buttons.underlinedButton.removeClass("active"),o.setVerticalAlignment(i.tableCellStyle.verticalAlignment),o.setHorizontalAlignment(i.tableCellStyle.horizontalAlignment)):r()}else r()}))},o.prototype.loadState=function(){},o.prototype.toHtml=function(){return'<div class="button undo">\n                    <i class="material-icons">undo</i>\n                </div>\n                <div class="button redo">\n                    <i class="material-icons">redo</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button content_cut">\n                    <i class="material-icons">content_cut</i>\n                </div>\n                <div class="button content_copy">\n                    <i class="material-icons">content_copy</i>\n                </div>\n                <div class="button content_paste">\n                    <i class="material-icons">content_paste</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button format_bold">\n                    <i class="material-icons">format_bold</i>\n                </div>\n                <div class="button format_italic">\n                    <i class="material-icons">format_italic</i>\n                </div>\n                <div class="button format_underlined">\n                    <i class="material-icons">format_underlined</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button align_vertical_top">\n                    <i class="material-icons">align_vertical_top</i>\n                </div>\n                <div class="button align_vertical_center">\n                    <i class="material-icons">align_vertical_center</i>\n                </div>\n                <div class="button align_vertical_bottom">\n                    <i class="material-icons">align_vertical_bottom</i>\n                </div>\n                <div class="separator"></div>\n                <div class="button format_align_left">\n                    <i class="material-icons">format_align_left</i>\n                </div>\n                <div class="button format_align_center">\n                    <i class="material-icons">format_align_center</i>\n                </div>\n                <div class="button format_align_right">\n                    <i class="material-icons">format_align_right</i>\n                </div>'},o.prototype.onClick=function(t){var e=t.target.closest(".button");e&&(e.classList.contains("undo")?this.undoButtonClick():e.classList.contains("redo")?this.redoButtonClick():e.classList.contains("content_cut")?this.cutButtonClick():e.classList.contains("content_copy")?this.copyButtonClick():e.classList.contains("content_paste")?this.pasteButtonClick():e.classList.contains("format_bold")?this.formatBoldButtonClick():e.classList.contains("format_italic")?this.formatItalicButtonClick():e.classList.contains("format_underlined")?this.formatUnderlinedButtonClick():e.classList.contains("align_vertical_top")?this.alignVerticalTopButtonClick():e.classList.contains("align_vertical_center")?this.alignVerticalCenterButtonClick():e.classList.contains("align_vertical_bottom")?this.alignVerticalBottomButtonClick():e.classList.contains("format_align_left")?this.formatAlignLeftButtonClick():e.classList.contains("format_align_center")?this.formatAlignCenterButtonClick():e.classList.contains("format_align_right")&&this.formatAlignRightButtonClick())},o.prototype.undoButtonClick=function(){console.log("undoButtonClick")},o.prototype.redoButtonClick=function(){console.log("redoButtonClick")},o.prototype.cutButtonClick=function(){this.observable.notify(n.CutCellsRequested)},o.prototype.copyButtonClick=function(){this.observable.notify(n.CopyCellsRequested)},o.prototype.pasteButtonClick=function(){this.observable.notify(n.PasteCellsRequested)},o.prototype.formatBoldButtonClick=function(){this.buttons.boldButton.toggleClass("active"),this.observable.notify(n.FormatBoldButtonClicked)},o.prototype.formatItalicButtonClick=function(){this.buttons.italicButton.toggleClass("active"),this.observable.notify(n.FormatItalicButtonClicked)},o.prototype.formatUnderlinedButtonClick=function(){this.buttons.underlinedButton.toggleClass("active"),this.observable.notify(n.FormatUnderlinedButtonClicked)},o.prototype.alignVerticalTopButtonClick=function(){this.setVerticalAlignment(l.Top),this.observable.notify(n.AlignVerticalTopButtonClicked)},o.prototype.alignVerticalCenterButtonClick=function(){this.setVerticalAlignment(l.Center),this.observable.notify(n.AlignVerticalCenterButtonClicked)},o.prototype.alignVerticalBottomButtonClick=function(){this.setVerticalAlignment(l.Bottom),this.observable.notify(n.AlignVerticalBottomButtonClicked)},o.prototype.formatAlignLeftButtonClick=function(){this.setHorizontalAlignment(r.Left),this.observable.notify(n.FormatAlignLeftButtonClicked)},o.prototype.formatAlignCenterButtonClick=function(){this.setHorizontalAlignment(r.Center),this.observable.notify(n.FormatAlignCenterButtonClicked)},o.prototype.formatAlignRightButtonClick=function(){this.setHorizontalAlignment(r.Right),this.observable.notify(n.FormatAlignRightButtonClicked)},o.prototype.setHorizontalAlignment=function(t){t===r.Center?(this.buttons.formatAlignLeftButton.removeClass("active"),this.buttons.formatAlignCenterButton.addClass("active"),this.buttons.formatAlignRightButton.removeClass("active")):t===r.Right?(this.buttons.formatAlignLeftButton.removeClass("active"),this.buttons.formatAlignCenterButton.removeClass("active"),this.buttons.formatAlignRightButton.addClass("active")):(this.buttons.formatAlignLeftButton.addClass("active"),this.buttons.formatAlignCenterButton.removeClass("active"),this.buttons.formatAlignRightButton.removeClass("active"))},o.prototype.setVerticalAlignment=function(t){t===l.Top?(this.buttons.alignVerticalTopButton.addClass("active"),this.buttons.alignVerticalCenterButton.removeClass("active"),this.buttons.alignVerticalBottomButton.removeClass("active")):t===l.Center?(this.buttons.alignVerticalTopButton.removeClass("active"),this.buttons.alignVerticalCenterButton.addClass("active"),this.buttons.alignVerticalBottomButton.removeClass("active")):(this.buttons.alignVerticalTopButton.removeClass("active"),this.buttons.alignVerticalCenterButton.removeClass("active"),this.buttons.alignVerticalBottomButton.addClass("active"))},o.componentName="toolbar",o.className="spreadsheet__"+o.componentName,o}(d),v=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),g=function(t){function e(e,o){return o.listeners=["keydown","input"],t.call(this,e,o)||this}return v(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.$root.find(".input");this.observable.subscribe(n.SingleCellSelected,(function(t){var o=t.content;b(o)||(o=""),e.textContent=o})),this.observable.subscribe(n.CellInput,(function(t){b(t)||(t=""),e.textContent=t}))},e.prototype.loadState=function(){},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.observable.dispose(n.SingleCellSelected),this.observable.dispose(n.CellInput)},e.prototype.toHtml=function(){return'<div class="info">f</div>\n                <div class="input" contenteditable="true" spellcheck="false"></div>'},e.prototype.onInput=function(t){if(b(t.data)){var e=t.target.textContent.trim();this.observable.notify(n.FormulaInput,e)}else t.preventDefault()},e.prototype.onKeydown=function(t){"Enter"===t.key&&this.observable.notify(n.NextCellSelectionRequested)},e.componentName="formula",e.className="spreadsheet__"+e.componentName,e.stateProperties={formulaBarText:"formulaBarText"},e}(d);function y(t){for(var e=[];t>0;){var o=String.fromCharCode((t-1)%26+"A".charCodeAt(0));e.push(o),t=Math.floor((t-1)/26)}return e.reverse().join("")}function S(t,e){for(var o='<div class="row" data-row-number="'+t+'" data-resizable="true">\n                    <div class="row-data">\n                        ',n=1;n<=e;n++)o+='<div class="cell align-vertical-bottom" data-cell-row-number="'+t+'" data-cell-column-number="'+n+'" contenteditable="true"></div>';return o+"</div></div>"}function w(t,e,o){return{type:p.changeCellContent,data:{columnNumber:t,rowNumber:e,value:o}}}function B(t,e,o){return{type:p.changeCellStyle,data:{columnNumber:t,rowNumber:e,cellStyle:o}}}!function(t){t.columnResize="columnResize",t.rowResize="rowResize",t.changeCellContent="changeCellContent",t.changeCellStyle="changeCellStyle"}(p||(p={}));var N=function(){function t(t,o){var l=this;this.spreadsheetEl=document.querySelector("."+_.className),this.observable=o,this.store=t,this.observable.subscribe(n.CellsDeselectionRequested,(function(){l.iterateOverSelectedCells((function(t){var o=e(t);o.textContent="",l.store.dispatch(w(+o.data.cellColumnNumber,+o.data.cellRowNumber,""))})),l.currentSelectedCell.textContent="",l.store.dispatch(w(+l.currentSelectedCell.data.cellColumnNumber,+l.currentSelectedCell.data.cellRowNumber,"")),l.observable.notify(n.CellInput,"")}))}return t.prototype.getSelectionRange=function(){return Object.freeze(this.currentSelectionRange)},t.prototype.selectCells=function(o){if(o.col1===o.col2&&o.row1===o.row2){this.clearSelection(),this.selectedPivot=null;var l=e(document.querySelector("."+_.className).querySelector('[data-cell-column-number="'+o.col1+'"][data-cell-row-number="'+o.row1+'"]'));this.currentSelectedCell=l,l.focus().addClass(t.selectedCellClassName),this.observable.notify(n.SingleCellSelected,{columnNumber:+l.data.cellColumnNumber,rowNumber:+l.data.cellRowNumber,content:l.textContent}),this.initialMouseSelectedCell=l}this.deselectPreviousSelection(),this.currentSelectionRange={col1:Math.min(o.col1,o.col2),row1:Math.min(o.row1,o.row2),col2:Math.max(o.col1,o.col2),row2:Math.max(o.row1,o.row2)},this.highlightSelectedCells()},t.prototype.getSelectedCells=function(){for(var t={},e=Math.min(this.currentSelectionRange.col1,this.currentSelectionRange.col2);e<=Math.max(this.currentSelectionRange.col1,this.currentSelectionRange.col2);e++)t[e]={};var o=this.store.getState();return this.iterateOverSelectedCells((function(e){var n=+e.dataset.cellColumnNumber,l=+e.dataset.cellRowNumber;t[n][l]=o.table.cellContents[n][l]})),t},t.prototype.clearSelection=function(){if(this.currentSelectedCell){var e=this.spreadsheetEl.querySelector('.table-header .column[data-column-number="'+this.currentSelectedCell.data.cellColumnNumber+'"]'),o=this.spreadsheetEl.querySelector('.column-row-info .row-info[data-row-number="'+this.currentSelectedCell.data.cellRowNumber+'"]');e.classList.remove(t.selectedCellClassName),o.classList.remove(t.selectedCellClassName),this.currentSelectedCell.removeClass(t.selectedCellClassName),this.currentSelectedCell=null}this.currentSelectionRange&&(this.deselectPreviousSelection(),this.currentSelectionRange=null)},t.prototype.applyCssClassToSelectedCells=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this.iterateOverSelectedCells((function(o){var n;(n=e(o)).addClass.apply(n,t)}))},t.prototype.removeCssClassFromSelectedCells=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this.iterateOverSelectedCells((function(o){var n;(n=e(o)).removeClass.apply(n,t)}))},t.prototype.highlightSelectedCells=function(){var e=this;this.iterateOverSelectedCells((function(o){o.classList.add(t.selectedCellClassName);var n=+o.dataset.cellColumnNumber,l=+o.dataset.cellRowNumber;e.currentSelectionRange.row1===l&&(e.currentSelectionRange.col1===n?o.classList.add(t.topLeftCorner):e.currentSelectionRange.col2===n?o.classList.add(t.topRightCorner):o.classList.add(t.topBorder)),e.currentSelectionRange.row2===l&&(e.currentSelectionRange.col1===n?o.classList.add(t.bottomLeftCorner):e.currentSelectionRange.col2===n?o.classList.add(t.bottomRightCorner):o.classList.add(t.bottomBorder)),e.currentSelectionRange.col1===n&&o.classList.add(t.leftBorder),e.currentSelectionRange.col2===n&&o.classList.add(t.rightBorder)}),(function(o){1!==e.currentSelectionRange.col1&&o.classList.add(t.selectedCellClassName)}),(function(o){1!==e.currentSelectionRange.row1&&o.classList.add(t.selectedCellClassName)}))},t.prototype.deselectPreviousSelection=function(){this.iterateOverSelectedCells((function(e){e.classList.remove(t.selectedCellClassName,t.topLeftCorner,t.topRightCorner,t.bottomLeftCorner,t.bottomRightCorner,t.topBorder,t.rightBorder,t.bottomBorder,t.leftBorder)}),(function(e){e.classList.remove(t.selectedCellClassName)}),(function(e){e.classList.remove(t.selectedCellClassName)}))},t.prototype.iterateOverSelectedCells=function(t,e,o){if(void 0===e&&(e=null),void 0===o&&(o=null),this.currentSelectionRange)for(var n=document.querySelector("."+_.className),l=n.querySelector('[data-column-number="'+this.currentSelectionRange.col1+'"]'),r=n.querySelector('[data-row-number="'+this.currentSelectionRange.row1+'"]'),i=n.querySelector('[data-column-number="'+this.currentSelectionRange.col2+'"]'),a=n.querySelector('[data-row-number="'+this.currentSelectionRange.row2+'"]'),s=r;s&&+s.dataset.rowNumber<=+a.dataset.rowNumber;){e&&e(s);for(var c=l,u=s.dataset.rowNumber;c&&+c.dataset.columnNumber<=+i.dataset.columnNumber;){o&&o(c);var d=c.dataset.columnNumber;t(n.querySelector('[data-cell-column-number="'+d+'"][data-cell-row-number="'+u+'"]')),c=c.nextElementSibling}s=s.nextElementSibling}},t.selectedCellClassName="selected",t.topLeftCorner="top-left-corner",t.topRightCorner="top-right-corner",t.bottomLeftCorner="bottom-left-corner",t.bottomRightCorner="bottom-right-corner",t.topBorder="top-border",t.rightBorder="right-border",t.bottomBorder="bottom-border",t.leftBorder="left-border",t}(),R=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),_=function(t){function o(e,o){var n=this;return o.listeners=["mousedown","mousemove","mouseup","keydown","input"],(n=t.call(this,e,o)||this).store=o.store,n}return R(o,t),o.prototype.init=function(){t.prototype.init.call(this),this.tableSelection=new N(this.store,this.observable),this.initFirstCellSelection(),this.initTableSubscriptions(),this.initTableScroll()},o.prototype.loadState=function(){var t=this.store.getState()[o.componentName];this.restoreColumnWidths(t),this.restoreRowHeights(t),this.restoreTableContent(t)},o.prototype.dispose=function(){t.prototype.dispose.call(this),this.observable.dispose(n.FormulaInput),this.observable.dispose(n.NextCellSelectionRequested)},o.prototype.toHtml=function(){return this.rowCount=100,this.columnCount=30,function(t,e){for(var o='<div class="table-header">'+function(t){for(var e='<div class="row">                    \n                    <div class="row-info"></div>\n                        <div class="row-data">',o=1;o<=t;o++)e+='<div class="column" data-column-number="'+o+'" data-resizable="true"><div class="column-title">'+y(o)+'</div><div data-resize="col" class="col-resize"></div></div>';return e+'</div><div class="row-column-info-patch"></div></div>'}(e)+'</div>\n                <div class="table-body"><div class="column-row-info-container"><div class="column-row-info">',n=1;n<=t;n++)o+='<div class="row-info" data-row-number="'+n+'"><div class="row-number">'+n+'</div><div class="row-resize"><div data-resize="row" class="handler"></div></div></div>';for(o+='</div></div><div class="table-wrapper">',n=1;n<=t;n++)o+=S(n,e);return o+'</div><div class="column-row-info-patch"></div></div>'}(this.rowCount,this.columnCount)},o.prototype.initFirstCellSelection=function(){this.tableSelection.selectCells({col1:1,row1:1,col2:1,row2:1}),this.tableSelection.initialMouseSelectedCell=null},o.prototype.initTableSubscriptions=function(){var t=this;this.observable.subscribe(n.FormulaInput,(function(e){t.tableSelection.currentSelectedCell.textContent=e;var o=+t.tableSelection.currentSelectedCell.data.cellColumnNumber,n=+t.tableSelection.currentSelectedCell.data.cellRowNumber;t.options.store.dispatch(w(o,n,e))})),this.observable.subscribe(n.NextCellSelectionRequested,(function(){var e=t.getNextCell("Enter");t.tableSelection.selectCells({col1:+e.data.cellColumnNumber,row1:+e.data.cellRowNumber,col2:+e.data.cellColumnNumber,row2:+e.data.cellRowNumber})})),this.observable.subscribe(n.CutCellsRequested,(function(){t.tableSelection.getSelectionRange()})),this.observable.subscribe(n.CopyCellsRequested,(function(){t.tableSelection.getSelectionRange()})),this.observable.subscribe(n.PasteCellsRequested,(function(){t.tableSelection.getSelectedCells()})),this.observable.subscribe(n.FormatBoldButtonClicked,(function(){var e=t.tableSelection.getSelectionRange();if(e.col1===e.col2||e.row1===e.row2){var o=t.store.getState().table.cellContents[e.col1][e.row1];b(o)&&b(o.tableCellStyle)&&b(o.tableCellStyle.bold)&&!0===o.tableCellStyle.bold?(t.tableSelection.removeCssClassFromSelectedCells("bold"),t.setCellStyle({bold:!1})):(t.tableSelection.applyCssClassToSelectedCells("bold"),t.setCellStyle({bold:!0}))}})),this.observable.subscribe(n.FormatItalicButtonClicked,(function(){var e=t.tableSelection.getSelectionRange();if(e.col1===e.col2||e.row1===e.row2){var o=t.store.getState().table.cellContents[e.col1][e.row1];b(o)&&b(o.tableCellStyle)&&b(o.tableCellStyle.italic)&&!0===o.tableCellStyle.italic?(t.tableSelection.removeCssClassFromSelectedCells("italic"),t.setCellStyle({italic:!1})):(t.tableSelection.applyCssClassToSelectedCells("italic"),t.setCellStyle({italic:!0}))}})),this.observable.subscribe(n.FormatUnderlinedButtonClicked,(function(){var e=t.tableSelection.getSelectionRange();if(e.col1===e.col2||e.row1===e.row2){var o=t.store.getState().table.cellContents[e.col1][e.row1];b(o)&&b(o.tableCellStyle)&&b(o.tableCellStyle.underlined)&&!0===o.tableCellStyle.underlined?(t.tableSelection.removeCssClassFromSelectedCells("underlined"),t.setCellStyle({underlined:!1})):(t.tableSelection.applyCssClassToSelectedCells("underlined"),t.setCellStyle({underlined:!0}))}})),this.observable.subscribe(n.AlignVerticalTopButtonClicked,(function(){t.tableSelection.removeCssClassFromSelectedCells("align-vertical-center","align-vertical-bottom"),t.tableSelection.applyCssClassToSelectedCells("align-vertical-top"),t.setCellStyle({verticalAlignment:l.Top})})),this.observable.subscribe(n.AlignVerticalCenterButtonClicked,(function(){t.tableSelection.removeCssClassFromSelectedCells("align-vertical-top","align-vertical-bottom"),t.tableSelection.applyCssClassToSelectedCells("align-vertical-center"),t.setCellStyle({verticalAlignment:l.Center})})),this.observable.subscribe(n.AlignVerticalBottomButtonClicked,(function(){t.tableSelection.removeCssClassFromSelectedCells("align-vertical-top","align-vertical-center"),t.tableSelection.applyCssClassToSelectedCells("align-vertical-bottom"),t.setCellStyle({verticalAlignment:l.Bottom})})),this.observable.subscribe(n.FormatAlignLeftButtonClicked,(function(){t.tableSelection.removeCssClassFromSelectedCells("format-align-center","format-align-right"),t.tableSelection.applyCssClassToSelectedCells("format-align-left"),t.setCellStyle({horizontalAlignment:r.Left})})),this.observable.subscribe(n.FormatAlignCenterButtonClicked,(function(){t.tableSelection.removeCssClassFromSelectedCells("format-align-left","format-align-right"),t.tableSelection.applyCssClassToSelectedCells("format-align-center"),t.setCellStyle({horizontalAlignment:r.Center})})),this.observable.subscribe(n.FormatAlignRightButtonClicked,(function(){t.tableSelection.removeCssClassFromSelectedCells("format-align-left","format-align-center"),t.tableSelection.applyCssClassToSelectedCells("format-align-right"),t.setCellStyle({horizontalAlignment:r.Right})}))},o.prototype.setCellStyle=function(t){for(var e=this.tableSelection.getSelectionRange(),o=e.col1;o<=e.col2;o++)for(var n=e.row1;n<=e.row2;n++)this.options.store.dispatch(B(o,n,t))},o.prototype.initTableScroll=function(){var t=this,e=0,o=0;this.$root.find(".table-wrapper").addEventListener("scroll",(function(n){var l=n.target,r=l.closest(".table-body").querySelector(".column-row-info"),i=t.$root.find(".table-header .row-data"),a=l.scrollLeft,s=l.scrollTop;e!==a&&(i.style.marginLeft=40-a+"px",e=a),o!==s&&(r.style.marginTop=-s+"px",o=s)}))},o.prototype.onMousedown=function(t){var e=this,o=t.target;this.performColumnOrRowResizing(o),this.performCellSelection(o,t.shiftKey);var n=function(o,n,l,r){var i,a,s;o===l?(i="column",a=o):(i="row",s=n),e.tableSelection.selectedPivot&&e.tableSelection.selectedPivot.type!==i&&(e.tableSelection.selectedPivot=null),t.shiftKey&&e.tableSelection.selectedPivot?"column"===i?o=e.tableSelection.selectedPivot.number:n=e.tableSelection.selectedPivot.number:e.tableSelection.selectedPivot={type:i,number:"column"===i?a:s},e.tableSelection.clearSelection(),e.tableSelection.selectCells({col1:o,row1:n,col2:l,row2:r})};this.performWholeRowsSelection(o.closest(".row-info"),n),this.performWholeColumnsSelection(o.closest(".column"),n)},o.prototype.performColumnOrRowResizing=function(t){if(t.dataset.resize){var o=e(t);if("col"===o.data.resize){var n=o.closest('[data-resizable="true"]');this.resizeColumn(n,o)}else{var l=o.closest(".row-info").data.rowNumber,r=e(o.closest(".table-body").find('.table-wrapper .row[data-row-number="'+l+'"]'));this.resizeRow(r,o)}}},o.prototype.performCellSelection=function(t,o){if(t.classList.contains("cell")){var n=this.tableSelection.currentSelectedCell;if(o&&n){var l=e(t);this.tableSelection.selectCells({col1:+n.data.cellColumnNumber,row1:+n.data.cellRowNumber,col2:+l.data.cellColumnNumber,row2:+l.data.cellRowNumber})}else{var r=e(t);this.tableSelection.selectCells({col1:+r.data.cellColumnNumber,row1:+r.data.cellRowNumber,col2:+r.data.cellColumnNumber,row2:+r.data.cellRowNumber})}}},o.prototype.performWholeRowsSelection=function(t,o){if(t&&t.childElementCount>0){var n=e(t.closest(".table-body")).find('.table-wrapper .row[data-row-number="'+t.dataset.rowNumber+'"]').querySelector(".row-data"),l=e(n.firstElementChild),r=e(n.lastElementChild);o(+l.data.cellColumnNumber,+l.data.cellRowNumber,+r.data.cellColumnNumber,+r.data.cellRowNumber)}else t&&0===t.childElementCount&&o(1,1,this.columnCount,this.rowCount)},o.prototype.performWholeColumnsSelection=function(t,o){if(b(t)){var n=e(t).data.columnNumber,l=this.$root.findAll('.cell[data-cell-column-number="'+n+'"]'),r=e(l[0]),i=e(l[l.length-1]);o(+r.data.cellColumnNumber,+r.data.cellRowNumber,+i.data.cellColumnNumber,+i.data.cellRowNumber)}},o.prototype.resizeColumn=function(t,o){var n=this,l=t.getCoords(),r=this.$root.findAll('[data-cell-column-number="'+t.data.columnNumber+'"]');o.css({height:"100vh"});var i={},a=function(t){t.target.classList.contains("column")&&(i[e(t.target).data.columnNumber]=t.target,t.target.style.pointerEvents="none");var n=t.pageX-o.getCoords().right;o.css({left:parseInt(window.getComputedStyle(o.$nativeElement).left)+n+"px",opacity:1})};document.addEventListener("mousemove",a),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",a),o.css({height:"",opacity:""});var e=o.getCoords().right-l.right,s=l.width+e;n.setColumnWidth(t,r,s),Object.keys(i).forEach((function(t){return i[t].style.removeProperty("pointer-events")}))}),{once:!0})},o.prototype.setColumnWidth=function(t,e,o){var n,l;t.css({width:o+"px"}),e.forEach((function(t){t.style.width=o+"px"})),this.store.dispatch((n=+t.data.columnNumber,l=o,{type:p.columnResize,data:{columnNumber:n,newColumnWidth:l}}))},o.prototype.resizeRow=function(t,o){var n=this,l=t.getCoords();o.css({width:"100%"});var r={},i=function(t){var n=t.target.closest(".row-info");if(n){var l=e(n).data.rowNumber;r[l]=n,n.style.pointerEvents="none"}var i=t.pageY-o.getCoords().bottom;o.css({top:parseInt(window.getComputedStyle(o.$nativeElement).top)+i+"px",opacity:1})};document.addEventListener("mousemove",i),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",i),o.css({width:"",opacity:""});var e=o.getCoords().bottom-l.bottom,a=l.height+e;n.setRowHeight(t,a),Object.keys(r).forEach((function(t){return r[t].style.removeProperty("pointer-events")}))}),{once:!0})},o.prototype.setRowHeight=function(t,o){var n=t.data.rowNumber;t.css({height:o+"px"}),e(t.closest(".table-body").find('.column-row-info .row-info[data-row-number="'+n+'"]')).css({height:o+"px"}),this.store.dispatch(function(t,e){return{type:p.rowResize,data:{rowNumber:t,newRowHeight:e}}}(+t.data.rowNumber,o))},o.prototype.onMouseup=function(t){this.tableSelection.initialMouseSelectedCell&&(this.tableSelection.initialMouseSelectedCell=null)},o.prototype.onMousemove=function(t){var o=t.target;if(this.tableSelection.initialMouseSelectedCell&&o.classList.contains("cell")){var n=e(o),l=this.tableSelection.initialMouseSelectedCell,r=this.tableSelection.getSelectionRange();if(r.col1===+l.data.cellColumnNumber&&r.row1===+l.data.cellRowNumber&&r.col2===+n.data.cellColumnNumber&&r.row2===+n.data.cellRowNumber)return;this.tableSelection.selectCells({col1:+l.data.cellColumnNumber,row1:+l.data.cellRowNumber,col2:+n.data.cellColumnNumber,row2:+n.data.cellRowNumber})}},o.prototype.onKeydown=function(t){if(["Enter","Tab","ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Home"].includes(t.key)){t.preventDefault();var e=this.getNextCell(t.key,t.shiftKey,t.ctrlKey);this.tableSelection.selectCells({col1:+e.data.cellColumnNumber,row1:+e.data.cellRowNumber,col2:+e.data.cellColumnNumber,row2:+e.data.cellRowNumber}),this.tableSelection.initialMouseSelectedCell=null}else"Delete"===t.key&&this.observable.notify(n.CellsDeselectionRequested)},o.prototype.onInput=function(t){var e=t.target.textContent.trim(),o=this.tableSelection.currentSelectedCell,l=+o.data.cellColumnNumber,r=+o.data.cellRowNumber;this.store.dispatch(w(l,r,e)),this.observable.notify(n.CellInput,e)},o.prototype.restoreColumnWidths=function(t){var o=this;Object.keys(t.columnWidths).forEach((function(n){var l=e(o.$root.find('.table-header [data-column-number="'+n+'"]')),r=o.$root.findAll('[data-cell-column-number="'+l.data.columnNumber+'"]'),i=t.columnWidths[n];o.setColumnWidth(l,r,i)}))},o.prototype.restoreRowHeights=function(t){var o=this;Object.keys(t.rowHeights).forEach((function(n){var l=e(o.$root.find('.table-wrapper .row[data-row-number="'+n+'"]')),r=t.rowHeights[n];o.setRowHeight(l,r)}))},o.prototype.restoreTableContent=function(t){var o=this;Object.keys(t.cellContents).forEach((function(n){Object.keys(t.cellContents[n]).forEach((function(i){var a=t.cellContents[n][i];if(a){var s=e(o.$root.find('[data-cell-column-number="'+n+'"][data-cell-row-number="'+i+'"]'));if(s){if(s.textContent=a.value,!b(a.tableCellStyle))return;!0===a.tableCellStyle.bold&&s.addClass("bold"),!0===a.tableCellStyle.italic&&s.addClass("italic"),!0===a.tableCellStyle.underlined&&s.addClass("underlined"),b(a.tableCellStyle.verticalAlignment)&&(s.removeClass("align-vertical-top","align-vertical-center","align-vertical-bottom"),s.addClass(function(t){if(t)switch(t){case l.Top:return"align-vertical-top";case l.Center:return"align-vertical-center";case l.Bottom:return"align-vertical-bottom";default:return""}}(a.tableCellStyle.verticalAlignment))),b(a.tableCellStyle.horizontalAlignment)&&(s.removeClass("format-align-left","format-align-center","format-align-right"),s.addClass(function(t){if(t)switch(t){case r.Left:return"format-align-left";case r.Center:return"format-align-center";case r.Right:return"format-align-right";default:return""}}(a.tableCellStyle.horizontalAlignment)))}}}))}))},o.prototype.getNextCell=function(t,o,n){void 0===o&&(o=!1),void 0===n&&(n=!1);var l=this.tableSelection.currentSelectedCell,r=+l.data.cellColumnNumber,i=+l.data.cellRowNumber,a=[r,i];return"Enter"===t?a=o?[r,i-1]:[r,i+1]:"Tab"===t?a=o?[r-1,i]:[r+1,i]:"ArrowUp"===t?a=[r,i-1]:"ArrowRight"===t?a=[r+1,i]:"ArrowDown"===t?a=[r,i+1]:"ArrowLeft"===t?a=[r-1,i]:"Home"===t&&(a=n?[1,1]:[1,i]),e(this.$root.find('[data-cell-column-number="'+a[0]+'"][data-cell-row-number="'+a[1]+'"]'))},o.componentName="table",o.className="spreadsheet__"+o.componentName,o.stateProperties={columnWidths:"columnWidths",rowHeights:"rowHeights",cellContents:"cellContents"},o}(d);function A(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var E="function"==typeof Symbol&&Symbol.observable||"@@observable",k=function(){return Math.random().toString(36).substring(7).split("").join(".")},L={INIT:"@@redux/INIT"+k(),REPLACE:"@@redux/REPLACE"+k(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+k()}};function O(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}var T,x=function(){return(x=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var l in e=arguments[o])Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t}).apply(this,arguments)},F=function t(e,o,n){var l;if("function"==typeof o&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(A(0));if("function"==typeof o&&void 0===n&&(n=o,o=void 0),void 0!==n){if("function"!=typeof n)throw new Error(A(1));return n(t)(e,o)}if("function"!=typeof e)throw new Error(A(2));var r=e,i=o,a=[],s=a,c=!1;function u(){s===a&&(s=a.slice())}function d(){if(c)throw new Error(A(3));return i}function m(t){if("function"!=typeof t)throw new Error(A(4));if(c)throw new Error(A(5));var e=!0;return u(),s.push(t),function(){if(e){if(c)throw new Error(A(6));e=!1,u();var o=s.indexOf(t);s.splice(o,1),a=null}}}function f(t){if(!O(t))throw new Error(A(7));if(void 0===t.type)throw new Error(A(8));if(c)throw new Error(A(9));try{c=!0,i=r(i,t)}finally{c=!1}for(var e=a=s,o=0;o<e.length;o++)(0,e[o])();return t}function b(t){if("function"!=typeof t)throw new Error(A(10));r=t,f({type:L.REPLACE})}function p(){var t,e=m;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(A(11));function o(){t.next&&t.next(d())}return o(),{unsubscribe:e(o)}}})[E]=function(){return this},t}return f({type:L.INIT}),(l={dispatch:f,subscribe:m,getState:d,replaceReducer:b})[E]=p,l}((function(t,e){switch(e.type){case p.columnResize:return(n=x({},t)).table.columnWidths[e.data.columnNumber]=e.data.newColumnWidth,n;case p.rowResize:return(n=x({},t)).table.rowHeights[e.data.rowNumber]=e.data.newRowHeight,n;case p.changeCellContent:(n=x({},t)).table.cellContents[e.data.columnNumber]||(n.table.cellContents[e.data.columnNumber]={});var o=n.table.cellContents[e.data.columnNumber][e.data.rowNumber];return b(o)?o.value=e.data.value:o={value:e.data.value},n.table.cellContents[e.data.columnNumber][e.data.rowNumber]=o,n;case p.changeCellStyle:var n;(n=x({},t)).table.cellContents[e.data.columnNumber]||(n.table.cellContents[e.data.columnNumber]={});var l=e.data.cellStyle,r=n.table.cellContents[e.data.columnNumber][e.data.rowNumber];return r||(r={tableCellStyle:{}}),r.tableCellStyle||(r.tableCellStyle={}),b(l.bold)&&(r.tableCellStyle.bold=l.bold),b(l.italic)&&(r.tableCellStyle.italic=l.italic),b(l.underlined)&&(r.tableCellStyle.underlined=l.underlined),b(l.verticalAlignment)&&(r.tableCellStyle.verticalAlignment=l.verticalAlignment),b(l.horizontalAlignment)&&(r.tableCellStyle.horizontalAlignment=l.horizontalAlignment),n.table.cellContents[e.data.columnNumber][e.data.rowNumber]=r,n;default:return t}}),(T=localStorage.getItem("appState"))?JSON.parse(T):{header:{},toolbar:{},table:{columnWidths:{},rowHeights:{},cellContents:{}}});F.subscribe((function(){var t=F.getState();localStorage.setItem("appState",JSON.stringify(t))})),new a("#app",{components:[f,h,g,_],store:F}).render()})();